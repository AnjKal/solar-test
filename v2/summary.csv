Section,Component,Term/Column,Electrical Meaning (Real World),How It Is Used in Code,Generation / Pattern
Reward/Penalty,MicrogridEnv.step,Safety override (invalid action),"Represents forbidden operating decisions (e.g., trying to island when grid is healthy, exporting when grid is down, or any action during maintenance). In real systems this maps to protection/operating rules and interlocks.","If _is_action_allowed() is false: reward -= 50; action forced to 4 (maintenance) or 0 (otherwise).","N/A (policy constraint, not generated)."
Reward/Penalty,MicrogridEnv.step,High blackout risk shaping (bp>0.6),"Models a high probability of grid outage or instability. Electrically: poor grid reliability / imminent outage; operator should prepare by islanding appropriately.","If blackout_probability>0.6 and not maintenance: penalize if action not in [2,3] (-10); reward islanding (+2) and reward correct mode (+2) else -2; required mode based on expected_outage_duration_min.","bp and expected_outage_duration_min come from dataset columns."
Reward/Penalty,MicrogridEnv.step,Outage duration threshold (120 min),"Separates expected long outages (preserve battery, shed non-critical loads) vs short outages (serve more load aggressively).","required_island_action = 2 if expected_outage_duration_min>=120 else 3.","expected_outage_duration_min generated in synthetic/forecast datasets."
Reward/Penalty,MicrogridEnv.step,Battery SOC bounds (soc_min=0.1 soc_max=0.9),"Represents operating limits that prevent deep discharge (battery damage) and overcharge (safety/aging).","SOC is clipped in [0.1,0.9]; charge/discharge power is limited by remaining SOC margin and efficiencies.","Initial SOC comes from dataset battery_soc but then evolves internally per action."
Reward/Penalty,MicrogridEnv.step,Charge efficiency (0.95),"Charging losses (converter + battery round-trip losses). You must draw more power than stored energy.","charged_kwh = charge_kw * timestep_hours * 0.95; SOC increases by charged_kwh/capacity.","Battery parameters come from dataset columns (capacity, max charge)."
Reward/Penalty,MicrogridEnv.step,Discharge efficiency (0.95),"Discharging losses (inverter + battery). Delivered kWh to load consumes more stored kWh.","battery_draw_kwh = (discharge_kw*timestep_hours)/0.95; SOC decreases by battery_draw_kwh/capacity.","Battery parameters come from dataset columns (capacity, max discharge)."
Reward/Penalty,MicrogridEnv.step,Grid-down wrong-mode penalty,"Electrically: when the grid is unavailable, staying ""grid-connected"" is not a meaningful operational mode; controller should switch to island operation strategies.","If grid unavailable (grid_status==0) and not maintenance and action not in [2,3,4]: reward -= 5.","grid_status and maintenance_active are dataset-driven."
Reward/Penalty,MicrogridEnv.step,Load prioritization (P1>P2>P3),"Critical loads (P1) must be served first (e.g., hospital, controls); P2 and P3 are progressively less critical and can be shed.","When islanded (effective_islanded): served_p1=min(load_p1, available_power) then served_p2 then served_p3.","Loads come from dataset columns load_p1_kw/load_p2_kw/load_p3_kw."
Reward/Penalty,MicrogridEnv.step,Safe shutdown action (4),"System shutdown / load shedding to protect equipment during maintenance or unsafe conditions.","If action==4: served_p1=served_p2=served_p3=0.","Maintenance windows are generated with blackout_type==2 and maintenance_active==1."
Reward/Penalty,MicrogridEnv.step,Export reward (action 5),"Feed-in / export of excess generation to grid (net metering / feed-in tariff).","If action 5 and grid_status==1: reward += export_kwh * 0.10, where export_kwh=max(0,(solar+discharge)-total_load)*1h.","Depends on solar_actual_kw, loads, and discharge power; grid must be available."
Reward/Penalty,MicrogridEnv.step,Critical load violation penalty,"Represents unacceptable loss of critical service (P1), which in real grids is usually the top constraint.","If served_p1 < load_p1: reward -= 100.","Driven by available island power and chosen action."
Reward/Penalty,MicrogridEnv.step,Load service rewards,"Encourages meeting demand, weighted by priority: P1 strongest, then P2, then P3.","reward += 5*(served_p1/load_p1) + 2*(served_p2/load_p2) + 0.5*(served_p3/load_p3).","Depends on served loads and load magnitudes."
Reward/Penalty,MicrogridEnv.step,Unnecessary islanding penalty,"Islanding when grid is healthy has costs: wear-and-tear, reduced power quality, operational risk.","If islanded and grid_status==1 and not high_risk: reward -= 5 and reward -= 2*(1-blackout_probability).","Uses blackout_probability as confidence that islanding was unnecessary."
Reward/Penalty,MicrogridEnv.step,Low SOC penalty (<0.25),"Battery protection: low SOC implies limited reserve, higher risk of outage to loads and battery stress.","If battery_soc < 0.25: reward -= 3.","SOC evolves due to actions; initial from dataset."
Reward/Penalty,MicrogridEnv.step,Maintenance violation penalty,"During maintenance you cannot operate islanding actions; physically equipment may be offline.","If maintenance_active==1 and is_islanded: reward -= 200.","maintenance_active comes from dataset; action allowed logic also enforces shutdown only."
Reward/Penalty,MicrogridEnv.step,Risk preparedness bonus,"When blackout probability is very high, having a healthy SOC is valuable as spinning reserve / backup energy.","If blackout_probability > 0.8 and battery_soc>=0.6: reward += max(0, battery_soc-0.6).","Depends on dataset risk and internal SOC."
Reward/Penalty,MicrogridEnv.step,Island efficiency bonus,"Rewards serving critical load in islanded mode: indicates effective use of local resources.","If islanded and served_p1>=load_p1: reward += 0.3.","Depends on local generation + battery discharge and load."
Reward/Penalty,MicrogridEnv.step,SOC band penalty (0.25-0.35 while islanded),"Discourages running near a low reserve margin while islanded (risk of collapse if solar drops or load spikes).","If islanded and 0.25<=battery_soc<0.35: reward -= 1.5.","Depends on internal SOC and action selection."
Reward/Penalty,MicrogridEnv.step,Forecast-aware shaping,"Forecast signals encourage charging before low-solar periods and discourage discharging when upcoming solar is weak.","If grid_status==1 and (solar_f1+solar_f4)<1.5: charge (action 1) gets +0.5; discharging actions [3,5] get -0.5.","Uses solar_forecast_t+1_kw and solar_forecast_t+4_kw."
Reward/Penalty,MicrogridEnv.step,Maintenance SOC incentives,"If maintenance (grid down), battery SOC readiness matters: low SOC is risky; higher SOC is valuable for local support.","If maintenance_active==1: battery_soc<0.5 => -2; battery_soc>=0.7 => +(battery_soc-0.7).","maintenance_active from dataset; SOC internal."
Reward/Penalty,MicrogridEnv.step,Action flapping penalty,"Frequent switching between islanded and grid-connected can cause transients, synchronization issues, and equipment stress.","If prev_islanded toggles: reward -= 0.5.","Depends on consecutive chosen actions."
Dataset Columns,Time Features,timestamp,"Timestamp of the simulated hour; real-world time reference.","Present in CSVs; env does not include it in observation_columns.","Generated as start_date + hour index in both generators."
Dataset Columns,Time Features,hour_sin/hour_cos,"Cyclical encoding of hour-of-day; captures daily solar/load periodicity without discontinuity at midnight.","Part of observations.","Computed as sin/cos(2π*hour/24)."
Dataset Columns,Time Features,day_sin/day_cos,"Cyclical encoding of day progression; captures seasonality (training) or scenario index (forecast).","Part of observations.","Synthetic: sin/cos(2π*day/365). Forecast: day fixed 0 so sin/cos constants."
Dataset Columns,Time Features,is_weekend,"Weekend flag; real loads often differ on weekends.","Part of observations.","Derived from timestamp weekday."
Dataset Columns,Solar,solar_actual_kw,"Actual PV power available locally (kW).","Used to compute available island power and export.","Synthetic: diurnal sine daylight * random peak. Forecast: diurnal sine with fixed peak (6.5 kW)."
Dataset Columns,Solar,solar_forecast_t+1_kw,"PV forecast one hour ahead (kW); models prediction uncertainty.","Used for forecast-aware reward shaping.","Synthetic: solar_actual scaled by random factor [0.7,1.3]. Forecast: solar_actual * 0.85."
Dataset Columns,Solar,solar_forecast_t+4_kw,"PV forecast four hours ahead (kW).","Used for forecast-aware reward shaping.","Synthetic: solar_actual scaled by random factor [0.6,1.4]. Forecast: solar_actual * 1.15."
Dataset Columns,Loads,load_p1_kw,"Priority-1 (critical) load demand (kW).","Critical constraint; unmet load triggers -100.","Synthetic: random base with evening bump; occasional overload. Forecast: fixed pattern with evening bump."
Dataset Columns,Loads,load_p2_kw,"Priority-2 load demand (kW).","Rewarded after P1.","Synthetic: random base with evening bump; occasional overload. Forecast: fixed pattern with evening bump."
Dataset Columns,Loads,load_p3_kw,"Priority-3 load demand (kW).","Lowest priority; smallest reward weight.","Synthetic: random base with evening bump; occasional overload. Forecast: fixed pattern with evening bump."
Dataset Columns,Battery,battery_soc,"State of charge fraction (0..1). Electrically: stored energy fraction.","Read at reset only; then SOC is updated internally via actions.","Synthetic: uniform [0.10,0.90]. Forecast: constant 0.85."
Dataset Columns,Battery,battery_capacity_kwh,"Battery energy capacity (kWh).","Used to convert SOC fraction to kWh for charging/discharging constraints.","Synthetic: constant default 20. Forecast: constant 20."
Dataset Columns,Battery,battery_max_charge_kw,"Charge power limit (kW).","Limits action 1 charging rate.","Synthetic: constant 5. Forecast: constant 5."
Dataset Columns,Battery,battery_max_discharge_kw,"Discharge power limit (kW).","Limits discharge actions 2/3/5.","Synthetic: constant 5. Forecast: constant 5."
Dataset Columns,Grid,grid_status,"1=grid available, 0=grid down. Electrically: upstream supply present/absent.","Controls whether grid-connected assumptions apply and which actions are allowed.","Synthetic: generated from blackout logic; forced 0 during maintenance. Forecast: scheduled hourly regimes; forced 0 during maintenance."
Dataset Columns,Grid,blackout_probability,"Probability proxy of near-term outage risk (0..1). Electrically: reliability metric.","Used for high-risk shaping, islanding penalties, and preparedness bonuses.","Synthetic: >=0.65 when high_blackout; otherwise <=0.60. Forecast: high windows at 0.70/0.85/0.95, otherwise 0.05."
Dataset Columns,Grid,blackout_type,"0=normal, 1=outage/risk, 2=maintenance outage.","Used to infer maintenance and outage context.","Synthetic: type2 assigned to ~50% of high-blackout rows. Forecast: fixed hour windows for type2 and type1."
Dataset Columns,Grid,expected_outage_duration_min,"Expected outage duration (minutes). Electrically: estimated repair/maintenance duration.","Used to choose conservative vs aggressive islanding strategy.","Synthetic: sampled ranges (maintenance 180-480; outage 30-240; risk-only 10-180; normal 0). Forecast: fixed per window (240/180/60)."
Dataset Columns,Grid,maintenance_active,"1=maintenance ongoing (grid down), else 0.","Hard safety constraint: only action 4 allowed; adds SOC readiness reward/penalty.","Synthetic: equals 1 iff blackout_type==2; implies grid_status==0. Forecast: equals 1 in specific hours; implies grid_status==0."
Dataset Columns,Derived,is_islanded,"Dataset flag indicating grid is down and not maintenance; informational.","Not used in observation_columns, but may be useful for diagnostics.","Synthetic/Forecast: computed as (grid_status==0 and maintenance_active==0)."
Dataset Columns,Derived,available_island_power_kw,"Upper bound proxy of island power (solar + max discharge).","Not used directly by env for served power, but useful for analysis/plots.","Computed as solar_actual_kw + battery_max_discharge_kw."
Generation,Training Dataset,generate_synthetic_microgrid_dataset,"Creates a multi-day hourly dataset combining time, solar, load, battery, and grid/blackout regimes.","Outputs synthetic_microgrid_dataset.csv; used by train_ppo.py via MicrogridEnv.","Loops days*24; solar uses diurnal daylight sine and random peak; loads have evening bump + overload probability; blackout uses Bernoulli for high_blackout (p=0.35) and maintenance conditional (p=0.50)."
 Generation,Forecast Dataset,generate_stress_evaluation_7_days,"Creates a 24-hour stress scenario used for scheduled inference.","Writes next_month_7_day_forecast.csv; consumed by ppo_inference.py then app.py.","Uses deterministic hourly regimes: 8/24 hours high blackout (>0.6) and 4/24 of those are maintenance (type2). Solar/load are deterministic diurnal patterns; SOC fixed at 0.85."
